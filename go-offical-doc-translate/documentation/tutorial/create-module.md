# 教程：创建一个 Go 模块
> **[↩ 返回到目录](../doc.md)**
## 目录

- 先决条件
- 创建一个可供他人使用的模块

---

这是 Go 语言入门教程的第一部分。本教程将带你了解 Go 的一些基础特性。如果你是 Go 的初学者，建议先阅读 [《开始使用 Go》](https://go.dev/doc/tutorial/getting-started) 教程，它介绍了 `go` 命令、Go 模块以及最简单的 Go 代码结构。

在本教程中，你将创建两个模块：

1. 一个**库模块**，专为被其他库或应用程序导入而设计；
2. 一个**调用者应用**，用于使用你刚刚创建的库。

整个教程包含七个简短的小节，每一节都会带你体验 Go 语言的一个不同特性：

- 创建一个模块 —— 编写一个包含可调用函数的小型模块；
- 从另一个模块调用你的代码 —— 导入并使用你新建的模块；
- 返回并处理错误 —— 添加简单的错误处理机制；
- 返回随机问候语 —— 学习使用切片（Go 中的动态数组）管理数据；
- 为多人生成问候语 —— 使用映射（map）存储键值对；
- 添加测试 —— 使用 Go 内置的单元测试功能来验证代码；
- 编译并安装应用程序 —— 将你的程序本地编译和安装。

> **提示**：更多教程请参见 [Go 官方教程列表](https://go.dev/doc/tutorial/)。

---

### 先决条件

- 具备一定的编程经验。本教程中的代码并不复杂，但如果你了解函数、循环和数组的基本概念，会更容易上手。
- 一个代码编辑器。任何文本编辑器都可以，但推荐使用对 Go 支持良好的工具，例如 [VSCode](https://code.visualstudio.com/)（免费）、[GoLand](https://www.jetbrains.com/go/)（付费）或 [Vim](https://www.vim.org/)（免费）。
- 一个命令行终端。Linux 和 macOS 用户可使用任意终端，Windows 用户可使用 PowerShell 或 cmd。

---

### 创建一个可供他人使用的模块

我们从创建一个 Go 模块开始。模块是组织一组相关包的方式，这些包共同提供一组完整且实用的功能。比如，你可以创建一个财务分析模块，包含多个用于计算和分析的包，供其他开发财务应用的人直接使用。关于模块开发的更多内容，请参考 [开发与发布模块](https://go.dev/doc/modules/developing)。

Go 的代码以**包**（package）为单位组织，多个包可以组合成一个**模块**（module）。你的模块会通过 `go.mod` 文件声明运行所需的依赖项，包括支持的 Go 版本以及其他所依赖的模块。

当你为模块添加新功能或优化现有功能时，可以发布新版本。其他开发者只需升级模块版本，就能在他们的项目中使用你更新后的代码，并在上线前充分测试。

#### 步骤如下：

1. 打开命令行终端，进入你的主目录。

   在 Linux 或 Mac 上：

   ```bash
   cd
   ```

   在 Windows 上：

   ```cmd
   cd %HOMEPATH%
   ```

2. 创建一个名为 `greetings` 的目录，用于存放你的模块代码。

   在主目录下执行：

   ```bash
   mkdir greetings
   cd greetings
   ```

3. 使用 `go mod init` 初始化模块。

   运行以下命令，并指定你的模块路径。本教程中我们使用 `example.com/greetings`。如果你将来要发布模块，这个路径应该是你的代码仓库地址，以便他人可以通过 Go 工具下载。

   ```bash
   go mod init example.com/greetings
   ```

   输出：

   ```
   go: creating new go.mod: module example.com/greetings
   ```

   `go mod init` 命令会创建一个 `go.mod` 文件，用于追踪你的代码依赖。目前这个文件只包含模块名称和所支持的 Go 版本。但随着你引入更多依赖，它会自动记录所依赖模块的具体版本，确保项目构建可重复，并让你对版本有完全的控制权。

4. 在编辑器中创建一个名为 `greetings.go` 的文件，开始编写代码。

5. 将以下代码粘贴进去并保存：

   ```go
   package greetings

   import "fmt"

   // Hello 返回对指定人物的问候语
   func Hello(name string) string {
       // 构造一条包含名字的问候消息
       message := fmt.Sprintf("Hi, %v. Welcome!", name)
       return message
   }
   ```

   这是你模块的第一段代码。它提供了一个简单的功能：接收一个名字，返回一句个性化的欢迎语。接下来，你将编写另一个模块来调用这个函数。

   代码说明：

    - 使用 `package greetings` 声明了一个名为 `greetings` 的包，用于组织相关函数；
    - 实现了 `Hello` 函数，用于生成并返回问候语。

      在 Go 中，**函数名以大写字母开头**，表示它是“导出的”（exported），也就是说其他包可以调用它。这种命名方式被称为“导出名”（Exported Name）。更多细节可参考 [Go 语言之旅](https://tour.golang.org/basics/3) 中的相关内容。
    - 声明了一个 `message` 变量来保存问候消息。

      Go 中的 `:=` 是一种快捷语法，用于在一行内声明并初始化变量（Go 会根据右侧值自动推断变量类型）。如果写得更详细一些，可以这样写：

      ```go
      var message string
      message = fmt.Sprintf("Hi, %v. Welcome!", name)
      ```

    - 使用 `fmt.Sprintf` 函数格式化字符串。`%v` 是一个占位符，会被 `name` 的值替换；
    - 最后将格式化完成的问候语返回给调用者。

---

下一步，你将创建另一个模块，来调用这个 `Hello` 函数。准备好了吗？让我们继续前进！

> **[↩ 返回到目录](../doc.md)**