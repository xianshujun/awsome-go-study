# æ•™ç¨‹ï¼šå¼€å§‹ä½¿ç”¨å¤šæ¨¡å—å·¥ä½œåŒº

> **[â†© è¿”å›žåˆ°ç›®å½•](../doc.md)**
## ç›®å½•

- å…ˆå†³æ¡ä»¶
- ä¸ºä½ çš„ä»£ç åˆ›å»ºä¸€ä¸ªæ¨¡å—
- åˆ›å»ºå·¥ä½œåŒº
- ä¸‹è½½å¹¶ä¿®æ”¹ `golang.org/x/example/hello` æ¨¡å—
- äº†è§£æ›´å¤šå…³äºŽå·¥ä½œåŒºçš„çŸ¥è¯†

tips: è¿™èŠ‚å†…å®¹è¾ƒä¸ºæŠ½è±¡ï¼Œå¦‚æžœä¸å¤ªç†è§£ï¼Œå¯ä»¥æŸ¥çœ‹[è¯¦ç»†è§£é‡Š](workspace-easydescribe.md)ã€‚

---

æœ¬æ•™ç¨‹å°†å¸¦ä½ äº†è§£ Go ä¸­**å¤šæ¨¡å—å·¥ä½œåŒº**ï¼ˆmulti-module workspacesï¼‰çš„åŸºç¡€çŸ¥è¯†ã€‚é€šè¿‡å¤šæ¨¡å—å·¥ä½œåŒºï¼Œä½ å¯ä»¥å‘Šè¯‰ Go å‘½ä»¤ï¼šä½ æ­£åœ¨åŒæ—¶å¼€å‘å¤šä¸ªæ¨¡å—ï¼Œå¹¶å¸Œæœ›åœ¨è¿™äº›æ¨¡å—ä¹‹é—´è½»æ¾åœ°æž„å»ºå’Œè¿è¡Œä»£ç ã€‚

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œä½ å°†åœ¨ä¸€ä¸ªå…±äº«çš„å¤šæ¨¡å—å·¥ä½œåŒºä¸­åˆ›å»ºä¸¤ä¸ªæ¨¡å—ï¼Œè·¨æ¨¡å—è¿›è¡Œä¿®æ”¹ï¼Œå¹¶ç«‹å³çœ‹åˆ°è¿™äº›æ›´æ”¹åœ¨æž„å»ºä¸­çš„æ•ˆæžœã€‚

> **æç¤º**ï¼šæ›´å¤šæ•™ç¨‹è¯·å‚è§ [Go å®˜æ–¹æ•™ç¨‹åˆ—è¡¨](https://go.dev/doc/tutorial/)ã€‚

---

### å…ˆå†³æ¡ä»¶

- å®‰è£…äº† **Go 1.18 æˆ–æ›´é«˜ç‰ˆæœ¬**ï¼›
- ä¸€ä¸ªç”¨äºŽç¼–å†™ä»£ç çš„ç¼–è¾‘å™¨ã€‚ä»»ä½•æ–‡æœ¬ç¼–è¾‘å™¨éƒ½å¯ä»¥ï¼›
- ä¸€ä¸ªå‘½ä»¤è¡Œç»ˆç«¯ã€‚Linux å’Œ macOS ç”¨æˆ·å¯ä½¿ç”¨ä»»æ„ç»ˆç«¯ï¼ŒWindows ç”¨æˆ·å¯ä½¿ç”¨ PowerShell æˆ– cmdã€‚

æœ¬æ•™ç¨‹è¦æ±‚ä½¿ç”¨ Go 1.18 æˆ–æ›´æ–°ç‰ˆæœ¬ã€‚è¯·ç¡®ä¿ä½ å·²ä»Ž [go.dev/dl](https://go.dev/dl) ä¸‹è½½å¹¶å®‰è£…äº†ç¬¦åˆç‰ˆæœ¬è¦æ±‚çš„ Goã€‚

---

### ä¸ºä½ çš„ä»£ç åˆ›å»ºä¸€ä¸ªæ¨¡å—

æˆ‘ä»¬å…ˆä»Žåˆ›å»ºä¸€ä¸ªæ¨¡å—å¼€å§‹ï¼Œç”¨äºŽå­˜æ”¾ä½ å³å°†ç¼–å†™çš„ä»£ç ã€‚

1. æ‰“å¼€ç»ˆç«¯ï¼Œè¿›å…¥ä½ çš„ä¸»ç›®å½•ã€‚

   åœ¨ Linux æˆ– Mac ä¸Šï¼š

   ```bash
   $ cd
   ```

   åœ¨ Windows ä¸Šï¼š

   ```cmd
   C:\> cd %HOMEPATH%
   ```

   åŽç»­æ•™ç¨‹ä¸­çš„å‘½ä»¤æç¤ºç¬¦ç»Ÿä¸€ç”¨ `$` è¡¨ç¤ºï¼Œä½†è¿™äº›å‘½ä»¤åœ¨ Windows ä¸ŠåŒæ ·é€‚ç”¨ã€‚

2. åˆ›å»ºä¸€ä¸ªåä¸º `workspace` çš„ç›®å½•ï¼Œä½œä¸ºä½ çš„å·¥ä½œåŒºæ ¹ç›®å½•ï¼š

   ```bash
   $ mkdir workspace
   $ cd workspace
   ```

3. åˆ›å»ºå¹¶åˆå§‹åŒ– `hello` æ¨¡å—

   æœ¬ç¤ºä¾‹å°†åˆ›å»ºä¸€ä¸ªåä¸º `hello` çš„æ–°æ¨¡å—ï¼Œå®ƒä¼šä¾èµ– `golang.org/x/example` æ¨¡å—ã€‚

   ```bash
   $ mkdir hello
   $ cd hello
   $ go mod init example.com/hello
   go: creating new go.mod: module example.com/hello
   ```

4. æ·»åŠ å¯¹ `golang.org/x/example/hello/reverse` åŒ…çš„ä¾èµ–ï¼š

   ```bash
   $ go get golang.org/x/example/hello/reverse
   ```

5. åœ¨ `hello` ç›®å½•ä¸‹åˆ›å»º `hello.go` æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

   ```go
   package main

   import (
       "fmt"
       "golang.org/x/example/hello/reverse"
   )

   func main() {
       fmt.Println(reverse.String("Hello"))
   }
   ```

6. è¿è¡Œç¨‹åºï¼š

   ```bash
   $ go run .
   olleH
   ```

   ç¨‹åºæˆåŠŸå°† `"Hello"` åè½¬ä¸º `"olleH"`ï¼Œè¯´æ˜Žæˆ‘ä»¬å·²ç»æ­£ç¡®ä½¿ç”¨äº†å¤–éƒ¨æ¨¡å—ä¸­çš„å‡½æ•°ã€‚

---

### åˆ›å»ºå·¥ä½œåŒº

æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª `go.work` æ–‡ä»¶ï¼Œå®šä¹‰ä¸€ä¸ªåŒ…å«å¤šä¸ªæ¨¡å—çš„å·¥ä½œåŒºã€‚

#### åˆå§‹åŒ–å·¥ä½œåŒº

åœ¨ `workspace` ç›®å½•ä¸‹è¿è¡Œï¼š

```bash
$ go work init ./hello
```

`go work init` å‘½ä»¤ä¼šä¸ºåŒ…å« `./hello` æ¨¡å—çš„å·¥ä½œåŒºåˆ›å»ºä¸€ä¸ª `go.work` æ–‡ä»¶ã€‚

Go å·¥å…·ä¼šç”Ÿæˆå¦‚ä¸‹å†…å®¹çš„ `go.work` æ–‡ä»¶ï¼š

```go
go 1.18

use ./hello
```

`go.work` æ–‡ä»¶çš„è¯­æ³•ä¸Ž `go.mod` ç±»ä¼¼ï¼š

- `go` æŒ‡ä»¤æŒ‡æ˜Žäº†è§£æžè¯¥æ–‡ä»¶æ‰€éœ€çš„ Go ç‰ˆæœ¬ï¼Œç±»ä¼¼äºŽ `go.mod` ä¸­çš„åŒåæŒ‡ä»¤ï¼›
- `use` æŒ‡ä»¤å‘Šè¯‰ Goï¼Œåœ¨æž„å»ºæ—¶åº”å°† `hello` ç›®å½•ä¸­çš„æ¨¡å—è§†ä¸ºâ€œä¸»æ¨¡å—â€ã€‚

è¿™æ„å‘³ç€ï¼Œåœ¨ `workspace` çš„ä»»æ„å­ç›®å½•ä¸­ï¼Œè¯¥å·¥ä½œåŒºçš„é…ç½®éƒ½ä¼šç”Ÿæ•ˆã€‚

#### åœ¨å·¥ä½œåŒºç›®å½•ä¸­è¿è¡Œç¨‹åº

åœ¨ `workspace` æ ¹ç›®å½•ä¸‹æ‰§è¡Œï¼š

```bash
$ go run ./hello
olleH
```

Go å‘½ä»¤ä¼šè‡ªåŠ¨å°†å·¥ä½œåŒºä¸­æ‰€æœ‰æ¨¡å—éƒ½è§†ä¸ºä¸»æ¨¡å—ï¼Œå› æ­¤å³ä½¿ä½ åœ¨æ¨¡å—å¤–éƒ¨è¿è¡Œå‘½ä»¤ï¼Œä¹Ÿèƒ½æ­£ç¡®è§£æžä¾èµ–ã€‚å¦‚æžœä¸ä½¿ç”¨å·¥ä½œåŒºï¼Œè¿™æ ·çš„è°ƒç”¨ä¼šå¤±è´¥ï¼Œå› ä¸º Go æ— æ³•ç¡®å®šè¯¥ä½¿ç”¨å“ªä¸ªæ¨¡å—ã€‚

---

### ä¸‹è½½å¹¶ä¿®æ”¹ `golang.org/x/example/hello` æ¨¡å—

æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æŠŠ `golang.org/x/example/hello` æ¨¡å—çš„æºç ä¸‹è½½åˆ°æœ¬åœ°ï¼ŒåŠ å…¥å·¥ä½œåŒºï¼Œå¹¶ä¸ºå…¶ `reverse` åŒ…æ·»åŠ ä¸€ä¸ªæ–°åŠŸèƒ½ â€”â€” åè½¬æ•´æ•°ã€‚ç„¶åŽä»Žæˆ‘ä»¬çš„ `hello` ç¨‹åºä¸­è°ƒç”¨è¿™ä¸ªæ–°å‡½æ•°ã€‚

#### 1. å…‹éš†ä»“åº“

åœ¨ `workspace` ç›®å½•ä¸‹è¿è¡Œï¼š

```bash
$ git clone https://go.googlesource.com/example
```

è¾“å‡ºç±»ä¼¼ï¼š

```
Cloning into 'example'...
remote: Total 165 (delta 27), reused 165 (delta 27)
Receiving objects: 100% (165/165), 434.18 KiB | 1022.00 KiB/s, done.
Resolving deltas: 100% (27/27), done.
```

å…‹éš†å®ŒæˆåŽï¼Œæºç å°†ä½äºŽ `./example` ç›®å½•ä¸­ï¼Œè€Œ `golang.org/x/example/hello` æ¨¡å—çš„å®žé™…ä»£ç ä½äºŽ `./example/hello`ã€‚

#### 2. å°†æ¨¡å—åŠ å…¥å·¥ä½œåŒº

è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°†æœ¬åœ°æ¨¡å—æ·»åŠ åˆ°å·¥ä½œåŒºï¼š

```bash
$ go work use ./example/hello
```

è¯¥å‘½ä»¤ä¼šåœ¨ `go.work` æ–‡ä»¶ä¸­æ·»åŠ ä¸€æ¡æ–°çš„ `use` æŒ‡ä»¤ã€‚çŽ°åœ¨æ–‡ä»¶å†…å®¹å˜ä¸ºï¼š

```go
go 1.18

use (
    ./hello
    ./example/hello
)
```

çŽ°åœ¨ï¼Œå·¥ä½œåŒºåŒæ—¶åŒ…å«äº†ï¼š

- æˆ‘ä»¬è‡ªå·±çš„ `example.com/hello` æ¨¡å—ï¼›
- æ¥è‡ª `golang.org/x/example/hello` çš„æ¨¡å—ï¼Œå®ƒæä¾›äº† `reverse` åŒ…ã€‚

**å…³é”®å¥½å¤„**ï¼šç”±äºŽæˆ‘ä»¬å°†æœ¬åœ°å‰¯æœ¬åŠ å…¥äº†å·¥ä½œåŒºï¼ŒGo ä¼šä¼˜å…ˆä½¿ç”¨æˆ‘ä»¬æœ¬åœ°çš„ `reverse` åŒ…ï¼Œè€Œä¸æ˜¯ä¹‹å‰é€šè¿‡ `go get` ä¸‹è½½åˆ°æ¨¡å—ç¼“å­˜ä¸­çš„ç‰ˆæœ¬ã€‚è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥è‡ªç”±ä¿®æ”¹å¹¶ç«‹å³æµ‹è¯•ã€‚

#### 3. æ·»åŠ æ–°å‡½æ•°

æˆ‘ä»¬å°†åœ¨ `reverse` åŒ…ä¸­æ·»åŠ ä¸€ä¸ªç”¨äºŽåè½¬æ•´æ•°çš„æ–°å‡½æ•°ã€‚

åˆ›å»ºæ–‡ä»¶ `workspace/example/hello/reverse/int.go`ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

```go
package reverse

import "strconv"

// Int è¿”å›žæ•´æ•° i çš„åè¿›åˆ¶æ•°å­—åè½¬ç»“æžœ
func Int(i int) int {
    i, _ = strconv.Atoi(String(strconv.Itoa(i)))
    return i
}
```

è¿™ä¸ªå‡½æ•°é€šè¿‡å°†æ•´æ•°è½¬ä¸ºå­—ç¬¦ä¸²ã€è°ƒç”¨å·²æœ‰çš„ `String` å‡½æ•°åè½¬ï¼Œå†è½¬å›žæ•´æ•°ï¼Œå®žçŽ°æ•°å­—åè½¬ã€‚

#### 4. ä¿®æ”¹ä¸»ç¨‹åºä»¥ä½¿ç”¨æ–°å‡½æ•°

ä¿®æ”¹ `workspace/hello/hello.go` æ–‡ä»¶ï¼Œæ›´æ–° `main` å‡½æ•°ï¼š

```go
package main

import (
    "fmt"
    "golang.org/x/example/hello/reverse"
)

func main() {
    fmt.Println(reverse.String("Hello"), reverse.Int(24601))
}
```

æˆ‘ä»¬åŒæ—¶è°ƒç”¨äº† `reverse.String` å’Œæ–°çš„ `reverse.Int` å‡½æ•°ã€‚

---

### åœ¨å·¥ä½œåŒºä¸­è¿è¡Œä»£ç 

åœ¨ `workspace` æ ¹ç›®å½•ä¸‹è¿è¡Œï¼š

```bash
$ go run ./hello
olleH 10642
```

è¾“å‡ºè¡¨æ˜Žï¼š

- `"Hello"` è¢«åè½¬ä¸º `"olleH"`ï¼›
- `24601` è¢«åè½¬ä¸º `10642`ã€‚

Go å‘½ä»¤é€šè¿‡ `go.work` æ–‡ä»¶æ­£ç¡®è§£æžäº†ä¸¤ä¸ªæ¨¡å—çš„è·¯å¾„ï¼š

- æ‰¾åˆ°äº† `hello` æ¨¡å—ï¼›
- ä½¿ç”¨æœ¬åœ°çš„ `golang.org/x/example/hello` æ¨¡å—æ¥è§£æž `reverse` åŒ…ã€‚

> **æç¤º**ï¼šä½¿ç”¨ `go.work` å¯ä»¥é¿å…åœ¨ `go.mod` ä¸­æ‰‹åŠ¨æ·»åŠ  `replace` æŒ‡ä»¤ï¼Œç‰¹åˆ«é€‚åˆåœ¨å¤šä¸ªæ¨¡å—é—´ååŒå¼€å‘ã€‚

ç”±äºŽä¸¤ä¸ªæ¨¡å—å¤„äºŽåŒä¸€å·¥ä½œåŒºï¼Œä½ å¯ä»¥åœ¨ä¸€ä¸ªæ¨¡å—ä¸­ä¿®æ”¹ä»£ç ï¼Œå¹¶ç«‹å³åœ¨å¦ä¸€ä¸ªæ¨¡å—ä¸­ä½¿ç”¨ï¼Œå¼€å‘æ•ˆçŽ‡å¤§å¤§æé«˜ã€‚

---

### åŽç»­æ­¥éª¤

å½“ä½ å®Œæˆå¼€å‘å¹¶å¸Œæœ›æ­£å¼å‘å¸ƒè¿™äº›æ¨¡å—æ—¶ï¼Œä½ éœ€è¦ä¸º `golang.org/x/example/hello` æ¨¡å—å‘å¸ƒä¸€ä¸ªæ­£å¼ç‰ˆæœ¬ï¼Œä¾‹å¦‚ `v0.1.0`ã€‚è¿™é€šå¸¸é€šè¿‡åœ¨ç‰ˆæœ¬æŽ§åˆ¶ç³»ç»Ÿä¸­ä¸ºæŸä¸ªæäº¤æ‰“ä¸Šæ ‡ç­¾ï¼ˆtagï¼‰æ¥å®žçŽ°ã€‚

å‘å¸ƒå®ŒæˆåŽï¼Œä½ å¯ä»¥æ›´æ–° `hello` æ¨¡å—å¯¹å®ƒçš„ä¾èµ–ï¼š

```bash
cd hello
go get golang.org/x/example/hello@v0.1.0
```

è¿™æ ·ï¼Œå³ä½¿è„±ç¦»å·¥ä½œåŒºï¼ŒGo å‘½ä»¤ä¹Ÿèƒ½æ­£ç¡®è§£æžå¹¶ä¸‹è½½è¿™ä¸ªç‰ˆæœ¬çš„æ¨¡å—ã€‚

---

### äº†è§£æ›´å¤šå…³äºŽå·¥ä½œåŒºçš„çŸ¥è¯†

é™¤äº†æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨çš„ `go work init`ï¼ŒGo è¿˜æä¾›äº†å…¶ä»–å‡ ä¸ªç”¨äºŽç®¡ç†å·¥ä½œåŒºçš„å­å‘½ä»¤ï¼š

- `go work use [-r] [dir]`  
  å°†æŒ‡å®šç›®å½•æ·»åŠ åˆ° `go.work` çš„ `use` åˆ—è¡¨ä¸­ï¼›å¦‚æžœç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™å°†å…¶ä»Žåˆ—è¡¨ä¸­ç§»é™¤ã€‚`-r` å‚æ•°è¡¨ç¤ºé€’å½’æ£€æŸ¥å­ç›®å½•ã€‚

- `go work edit`  
  ç±»ä¼¼äºŽ `go mod edit`ï¼Œå¯ç›´æŽ¥ç¼–è¾‘ `go.work` æ–‡ä»¶ï¼Œæ¯”å¦‚æ·»åŠ æˆ–åˆ é™¤æ¨¡å—ã€‚

- `go work sync`  
  å°†å·¥ä½œåŒºæž„å»ºåˆ—è¡¨ä¸­çš„ä¾èµ–é¡¹åŒæ­¥åˆ°å„ä¸ªæ¨¡å—çš„ `go.mod` æ–‡ä»¶ä¸­ï¼Œç¡®ä¿ä¾èµ–ä¸€è‡´æ€§ã€‚

æ›´å¤šç»†èŠ‚ï¼Œè¯·å‚è€ƒ [Go æ¨¡å—å‚è€ƒæ–‡æ¡£ä¸­çš„â€œå·¥ä½œåŒºâ€ç« èŠ‚](https://go.dev/ref/mod#workspaces)ã€‚

---

ðŸŽ‰ æ­å–œï¼ä½ å·²ç»æŽŒæ¡äº† Go å¤šæ¨¡å—å·¥ä½œåŒºçš„åŸºæœ¬ç”¨æ³•ã€‚è¿™ç§æœºåˆ¶éžå¸¸é€‚åˆåœ¨å¾®æœåŠ¡ã€ç»„ä»¶åº“æˆ–å¤šå›¢é˜Ÿåä½œé¡¹ç›®ä¸­è¿›è¡Œé«˜æ•ˆå¼€å‘ã€‚ç»§ç»­æŽ¢ç´¢ï¼Œè®© Go çš„æ¨¡å—ç³»ç»Ÿä¸ºä½ çš„é¡¹ç›®èµ‹èƒ½ï¼

> **[â†© è¿”å›žåˆ°ç›®å½•](../doc.md)**